Функция Index() Экспорт
	ПредставлениеСтраницы = Представление(НастройкиСинхронизации.ПолучитьДанныеНастроек());
	Возврат ПредставлениеСтраницы;
КонецФункции

Функция Save() Экспорт
	Если ЗапросHttp.Метод = "POST" Тогда
		Данные = Новый Структура("dir, url, user, password, privateToken, SSHkey",
			ЗапросHttp.ДанныеФормы["Dir"],
			ЗапросHttp.ДанныеФормы["Url"],
			ЗапросHttp.ДанныеФормы["User"],
			ЗапросHttp.ДанныеФормы["Password"],
			ЗапросHttp.ДанныеФормы["PrivateToken"],
			ЗапросHttp.ДанныеФормы["SSHkey"]
			);
		НастройкиСинхронизации.Записать(Данные);
	КонецЕсли;

	Возврат Представление("Index", НастройкиСинхронизации.ПолучитьДанныеНастроек());
КонецФункции

Функция Generatessh() Экспорт
	Возврат Представление("Index", НастройкиСинхронизации.СгенерироватьSSH());
КонецФункции

Функция SaveSettingsAndGetSsh() Экспорт
	Если ЗапросHttp.Метод = "POST" Тогда
		Поток = ЗапросHttp.ПолучитьТелоКакПоток();
		Чтение = Новый ЧтениеДанных(Поток);
    	СтрокаДанных = Чтение.ПрочитатьСтроку("utf-8");

		Возврат Содержимое(НастройкиСинхронизации.СохранитьНастройкиИВернутьSSH(СтрокаДанных));
	КонецЕсли;

	Возврат "";
КонецФункции

Функция GetSettings() Экспорт
	Возврат Содержимое(НастройкиСинхронизации.ПолучитьДанныеНастроек());
КонецФункции
